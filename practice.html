<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>practice</title>
</head>

<body>
    <h1>practice</h1>
    <script>
//  I want you to create one function called updateLastUserActivityTime which returns a promise.
//  Every time the user creates a post, 
//  the user's lastActivity time should get called (should execute in 1 second).
//  When both the promises resolve (createPost and updateLastUserActivityTime ),
//  I want you to console log all the posts created and lastActivityTime of the user. 
//  [If stuck for long watch the hint 2]
//  Once both the above promises are resolved ,
//  I want you to delete the last post by calling the deletion promise.
//  Once successfully deleted, I want you to log the new set of Posts of the user.
const posts = []

function updateLastUserActivityTime() {
    return new Promise ((resolve, rejects)=>{
        let lastActivityTime = new Date().getTime()
        console.log(lastActivityTime);
        resolve(lastActivityTime)        
    })
}

function createPost(post) {
    return new Promise ((resolve, rejects)=> {
        setTimeout(()=>{
            posts.push(post)
            resolve()
        }, 1000)
    })
}

function deleteLastPost() {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      if (posts.length > 0) {        
        const deletedPost = posts.pop()
        resolve(deletedPost)
      } else {
        reject("ERROR: ARRAY IS EMPTY")
      }
    }, 1000);
  })
}


// createPost({ title: "Post 1" })
//   .then(updateLastUserActivityTime())
//   .then(createPost({ title: "Post 2" }))
//   .then(updateLastUserActivityTime())
//   .then(createPost({ title: "Post 3" }))
//   .then(updateLastUserActivityTime())
//   .then(createPost({ title: "Post 4" }))
//   .then(updateLastUserActivityTime())
//   .then(createPost({ title: "Post 5" }))
//   .then(updateLastUserActivityTime())
//   .then(createPost({ title: "Post 6" }))
//   .then(updateLastUserActivityTime())
//   .then(deleteLastPost())
//   .then(console.log(posts))

Promise.all([createPost({ title: "Post 1" }),updateLastUserActivityTime()])
.then(Promise.all([createPost({ title: "Post 2" }),updateLastUserActivityTime()]))
.then(Promise.all([createPost({ title: "Post 3" }),updateLastUserActivityTime()]))
.then(Promise.all([createPost({ title: "Post 4" }),updateLastUserActivityTime()]))
.then(Promise.all([createPost({ title: "Post 5" }),updateLastUserActivityTime()]))
.then(deleteLastPost())
.then(console.log(posts))
.catch(error => console.log(error)); 

    </script>
</body>

</html>